# Case Study
## Early Incident Identification 

Disc Consulting Enterprises (DCE) has identified some potentially suspicious attacks on their network and computer systems. The attacks are thought to be a new type of attack from a skilled threat actor. To date, the attacks have only been identified ‘after the fact’ by examining post-exploitation activities of the attacker on compromised systems. 

Unfortunately, the attackers are skilled enough to evade detection and the exact mechanisms of their exploits have not been identified. The incident response team, including IT services, security operations, security architecture, risk management, the CISO (Chief Information Security Officer), and the CTO (Chief Technology Officer) have been meeting regularly to determine next steps. It has been suggested that the security architecture and operations teams could try to implement some real-time threat detection using machine learning models that build on earlier consultancy your firm has completed (i.e., building upon your Assessment 1 work). 

## Data description 

The data you will use is the same data set provided in Assessment 1. It is provided again below.  

[Download dataset](https://ao.ecu.edu.au/CYB6009/Assessments/2023/MLData2023.csv)

Things to keep in mind: 

- Each event record is a snapshot triggered by an individual network ‘packet’. The exact triggering conditions for the snapshot are unknown. But it is known that multiple packets are exchanged in a ‘TCP conversation’ between the source and the target before an event is triggered and a record created. It is also known that each event record is anomalous in some way (the SIEM logs many events that may be suspicious).
- The malicious events account for a very small amount of data. As such, your training needs to consider the “imbalanced” data and the effect these data may have on accuracy (both specificity and sensitivity).

A very small proportion of the data are known to be corrupted by their source systems and some data are incomplete or incorrectly tagged. The incident response team indicated this is likely to be less than a few hundred records. A list of the relevant features in the data is given below.



About the dataset

| Variable                                      | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| --------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Assembled Payload Size (continuous)           | The total size of the inbound suspicious payload. Note: This would contain the data sent by the attacker in the “TCP conversation” up until the event was  triggered.                                                                                                                                                                                                                                                                                                                                                 |
| DYNRiskA Score (continuous)                   | An untested in-built risk score assigned by a new SIEM plug-in.                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| IPV6 Traffic (binary)                         | A flag indicating whether the triggering packet was using IPV6 or IPV4 protocols (True = IPV6).                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Response Size (continuous)                    | The total size of the reply data in the TCP  conversation prior to the triggering packet.                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Source Ping Time (ms) (continuous)            | The ‘ping’ time to the IP address which triggered the event record. This is affected by network structure, number of ‘hops’ and even physical distances. E.g.: <br><br>- < 1 ms is typically local to the device<br>- 1-5ms is usually located in the local network<br>- 5-50ms is often geographically local to a country<br>- ~100-250ms is trans-continental to servers<br>- 250+ may be trans-continental to a small network. <br><br>_Note, these are estimates only and many factors can influence ping times._ |
| Operating System (Categorical)                | A limited ‘guess’ as to the operating system that generated the inbound suspicious connection. This is not accurate, but it should be somewhat consistent for each ‘connection’.                                                                                                                                                                                                                                                                                                                                      |
| Connection State (Categorical)                | An indication of the TCP connection state at the time the packet was triggered.                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Connection Rate (continuous)                  | The number of connections per second by the inbound suspicious connection made prior to the event record creation.                                                                                                                                                                                                                                                                                                                                                                                                    |
| Ingress Router (Binary)                       | DCE has two main network connections to the ‘world’. This field indicates which connection the events arrived through.                                                                                                                                                                                                                                                                                                                                                                                                |
| Server Response Packet Time (ms) (continuous) | An estimation of the time from when the payload was sent to when the reply packet was generated. This may indicate server processing time/load for the event.                                                                                                                                                                                                                                                                                                                                                         |
| Packet Size (continuous)                      | The size of the triggering packet.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Packet TTL (continuous)                       | The time-to-live (TTL) of the previous inbound packet. TTL can be a measure of how many ‘hops’ (routers) a packet has traversed before arriving at our network.                                                                                                                                                                                                                                                                                                                                                       |
| Source IP Concurrent Connection (Continuous)  | How many concurrent connections were open from the source IP at the time the event was triggered.                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Class (Binary)                                | Indicates if the event was confirmed malicious, i.e., 0 = Non-malicious, 1 = Malicious.                                                                                                                                                                                                                                                                                                                                                                                                                               |
## The needle in the haystack

The data were gathered over a period of time and processed by several systems in order to associate specific events with confirmed malicious activities. However, the number of confirmed malicious events was very low, with these events accounting for less than 1% of all logged network events. Because the events associated with malicious traffic are quite rare, rate of ‘false negatives’ and ‘false positives’ are important . 

## Scenario

Following the meetings of the security incident response team, it has been decided to try to make an ‘early warning’ system that extends the functionality of their current SIEM. It has been proposed that DCE engage 3rd party developers to create a ‘smart detection plugin’ for the SIEM. 

The goal is to have a plug-in that would extract data from real-time network events, send it to an external system (your R script) and receive a classification in return. However, for the plugin to be effective it must consider the alert-fatigue experienced by security operations teams as excessive false-positives can lead to the team ignoring real incidents. But, because the impact of a successful attack is very high, false negatives could result in attackers overtaking the whole network.